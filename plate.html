<style type="text/css" media="all">
    body { font-family: sans-serif; }
    table {
        table-layout: fixed;
        border-collapse: collapse;
    }
    table th {
        color: #666;
        font-family: monospace;
        font-weight: normal;
        border: 1px solid #EEE;
    }
    table td {
        border: 1px solid #EEE;
    }
    table tbody tr:nth-child(even) {
        background: #F0F0F0;
    }
    table td code {
        display: block;
        text-align: center;
    }
    table th, table td {
        padding: 8px 10px;
    }
    kbd { color: blue; }
    .header {
        text-align: center;
        border-bottom: 1px dashed #CCC;
        margin-bottom: 20px;
    }
</style>
<style type="text/css" media="print">
    table {
        font-size: 8px;
        width: 100%;
        table-layout: auto;
    }
    table th, table td {
        padding: 5px 8px;
    }
</style>

<!-- <code><kbd>Asym</kbd> = Asymmetrical, <kbd>Sym</kbd> = Symmetrical, <kbd>Unidir</kbd> = Unidirectional</code>
<hr> -->
<div class="header">
    <h3>Consumer Count Survey</h3>
</div>
<table align="center">
    <thead>
        <tr>
            <th colspan="3">&nbsp;</th>
            <th colspan="2">Section Width</th>
            <th colspan="2">Aspect Ratio</th>
            <th colspan="2">Rim Diameter</th>
            <th colspan="4">Tyre Brand</th>
        </tr>
        <tr>
            <th>#</th>
            <th>Plate No</th>
            <th>Make &amp; Model</th>
            <th>Front</th>
            <th>Rear</th>
            <th>Front</th>
            <th>Rear</th>
            <th>Front</th>
            <th>Rear</th>
            <th>Front Left</th>
            <th>Rear Left</th>
            <th>Front Right</th>
            <th>Rear Right</th>

        </tr>
    </thead>
    <tbody id="table_body"></tbody>
</table>


<script src="jquery.min.js"></script>
<script type="text/javascript">

var row_wanted = parseInt(window.location.search.substring(1)) || 10


var rand = function(array) {
    var i = Math.floor((array.length)*Math.random());
    return i;
}

var cars = [
    { make: 'Toyota', variant: ['Vios', 'Avanza', 'Camry', 'Wish', 'Corolla'] },
    { make: 'Proton', variant: ['Saga', 'Gen2', 'Exora', 'Satria', 'Pesona'] },
    { make: 'Honda', variant: ['City', 'Civic', 'Accord', 'Odyssey', 'CR-V', 'Jazz'] },
    { make: 'Perodua', variant: ['Myvi', 'Axia', 'Kancil', 'Alza', ] },
    { make: 'Nissan', variant: ['Teana', 'Sylphy', 'Almera', 'Grand Livina', 'Murano', 'Cefiro'] },
    { make: 'BMW', variant: ['3 Series', '5 Series'] },

    { make: 'Ford', variant: ['Focus', 'Fiesta', 'Mondeo'] },
    { make: 'Volkswagen', variant: ['Beetle', 'Polo', 'Jetta', 'Scirocco', 'Passat'] },
    { make: 'Hyundai', variant: ['Ascend', 'Elantra', 'Tucson'] }
];

var tyre = {
    brands: [
        { name: 'GoodYear', patterns: ['FuelMax', 'ComforTred', 'TripleTred'] },
        { name: 'Michelin', patterns: ['XLINE', 'XMULTI', 'XINCITY'] },
        { name: 'Dunlop', patterns: ['StreetResponse2', 'Sport Maxx RT', 'Sport Maxx TT'] },
        { name: 'Hankook', patterns: ['K120', 'H452', 'H457', 'K107', 'K110', 'K115', 'K117', 'Z222', 'H433', 'H308'] },
        { name: 'Kumho', patterns: ['ECSTA XS', 'ECSTA V720', 'ECSTA LE SPORT', 'ECSTA SPT', 'ECSTA ASX'] },
        { name: 'Maxxis', patterns: ['M36', 'VICTRA MA510', 'VICTRA PRO R1', 'MA-1', 'MA-P1'] },
        { name: 'Silverstone', patterns: ['NS-500', 'PowerBlitz 1800', 'PowerBlitz 200', 'NS-223', 'NS-700', 'Atlantis V7', 'Synergy M5', 'Synergy M3'] },
        { name: 'GT Radial', patterns: ['CHAMPIRO ECO', 'CHAMPIRO WT PLUS'] },
        { name: 'Continental', patterns: ['ComfortContact', 'EcoContact', 'PremiumContact', 'SportContact'] },
        { name: 'Falken', patterns: ['SN211', 'PT722', 'PROG4', 'ZE612', 'ZE329', 'SN828'] },
        { name: 'Toyo', patterns: ['T1', 'R1R', 'C1S', 'T1R'] },
        { name: 'Yokohama', patterns: ['ADVAN SPORT', 'NEOVA', 'ADVAN DB', 'CDRIVE', 'SDRIVE', 'ADVAN R1'] },
        { name: 'Bridgestone', patterns: ['RE001', 'RE050', 'RE050A', 'ER300', 'ER592', 'RE92', 'ER60', 'B249', 'B800'] },
        { name: 'Pirelli', patterns: ['PZERO', 'P1', 'P7'] }
    ],
    // pattern: ['Asym', 'Sym', 'Unidir', 'Asym & Unidir'],
    sw: [145,155,165,175,185,195,205,215,225,235,245,255,265,275,285,295,305,315,325,335],
    ar: [25,30,35,40,45,50,55,60,65,70,75],
    rd: [12,13,14,15,16,17,18,19,20,21,22],
    rw: [5.0, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5]
}

var get_ideal_tyre = function() {
    return $.ajax({
        url: 'http://www.tyresizecalculator.com/index.php?option=com_tsc&callback=resultTable&wheelwidth='+ tyre.rw[rand(tyre.rw)] +'&wheeldiameter='+ tyre.rd[rand(tyre.rd)] +'&task=tyre4rim&_=1442930757810',
        type: 'GET',
        dataType: 'jsonp'
    })
}

var maketyre = function() {
    var i = rand(tyre.brands)
    return tyre.brands[i].name + ' <kbd>(' + tyre.brands[i].patterns[rand(tyre.brands[i].patterns)] + ')</kbd>'
}

var makeplate = function() {
    var alphabets = 'ABCDEFGHJKLMNPQRSTUVWXY';
    var number = '1234567890';
    var state = ['J', 'J', 'J', 'B', 'W']
    var plate = state[rand(state)];
    var plateno = Math.floor(Math.random()*9999);

    for(var i=0; i < 2; i++) {
        plate += alphabets.charAt(Math.floor(Math.random() * alphabets.length));
    }

    return plate + plateno;
}

var makecar = function() {
    var a = rand(cars)
    var car = cars[a].make + ' ' + cars[a].variant[rand(cars[a].variant)];
    return car;
}

var textgen = function(ix, res) {
    var text = '';
    text += '<tr><td><code>' + ix + '</code></td><td><code>' + makeplate() + '</code></td><td>' + makecar() + '</td>';
    // Section Width
    text += '<td><code>' + res.width + '</code></td>';
    text += '<td><code>' + res.width + '</code></td>';
    // Aspect Ratio
    text += '<td><code>' + res.ar + '</code></td>';
    text += '<td><code>' + res.ar + '</code></td>';
    // Rim Diameter
    text += '<td><code>' + res.diam + '</code></td>';
    text += '<td><code>' + res.diam + '</code></td>';
    // Tyre Brand
    var front = maketyre();
    var back = maketyre();
    text += '<td>' + maketyre() + '</td>';
    text += '<td>' + maketyre() + '</td>';
    text += '<td>' + maketyre() + '</td>';
    text += '<td>' + maketyre() + '</td>';
    return text
}

var rowdata = '';
var rows = 0;
var ind = 0;
var loopthis = setInterval(generateRows, 1);

function generateRows() {
    rows++
    get_ideal_tyre().then(function(res) {
        ind++
        if (res.idealtyres) {
            if (res.idealtyres.length) {
                rowdata += textgen(ind, res.idealtyres[0])
            } else if (res.maxtyres.length) {
                rowdata += textgen(ind, res.maxtyres[0])
            } else {
                rowdata += textgen(ind, res.mintyres[0])
            }
        } else {
            res.width = tyre.sw[rand(tyre.sw)];
            res.ar = tyre.ar[rand(tyre.ar)];
            res.diam = tyre.rd[rand(tyre.rd)];
            rowdata += textgen(ind, res);
        }

        $('#table_body').html(rowdata);
    });
    if (rows == row_wanted) {
        clearInterval(loopthis);
    }
}

</script>